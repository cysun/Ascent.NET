CREATE TABLE "Groups" (
    "Id" integer GENERATED BY DEFAULT AS IDENTITY,
    "Name" character varying(32) NOT NULL,
    "Description" text NULL,
    "EmailPreference" character varying(10) NOT NULL,
    "IsVirtual" boolean NOT NULL,
    CONSTRAINT "PK_Groups" PRIMARY KEY ("Id")
);

INSERT INTO "Groups" ("Name", "Description", "EmailPreference", "IsVirtual") VALUES ('BS Alumni',
  'This is a virtual group that includes everyone who has a valid BG Term and a personal (i.e. non-CSULA) email.',
  'Personal', true);

INSERT INTO "Groups" ("Name", "Description", "EmailPreference", "IsVirtual") VALUES ('MS Alumni',
  'This is a virtual group that includes everyone who has a valid GG Term and a personal (i.e. non-CSULA) email.',
  'Personal', true);

CREATE TABLE "GroupMembers" (
    "GroupId" integer NOT NULL,
    "PersonId" integer NOT NULL,
    CONSTRAINT "PK_GroupMembers" PRIMARY KEY ("GroupId", "PersonId"),
    CONSTRAINT "FK_GroupMembers_Groups_GroupId" FOREIGN KEY ("GroupId") REFERENCES "Groups" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_GroupMembers_Persons_PersonId" FOREIGN KEY ("PersonId") REFERENCES "Persons" ("Id") ON DELETE CASCADE
);

CREATE INDEX "IX_GroupMembers_PersonId" ON "GroupMembers" ("PersonId");

CREATE UNIQUE INDEX "IX_Groups_Name" ON "Groups" ("Name");

DELETE FROM "__EFMigrationsHistory";
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion") VALUES ('20220822042935_InitialSchema', '6.0.8');
